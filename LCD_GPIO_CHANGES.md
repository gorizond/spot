# Изменения для добавления GPIO реализации в LCD C++ приложение

## Обзор

Были внесены изменения в LCD C++ приложение для добавления полноценной реализации GPIO функций, позволяющих управлять LCD дисплеем через GPIO пины Raspberry Pi.

## Внесенные изменения

### 1. spot_lcd_cpp/src/lcd_core.cpp

**Полностью обновлен** с добавлением:

- Реализация GPIO функций: `pulseEnable()`, `sendNibble()`, `sendByte()`
- Правильная инициализация LCD дисплея в 4-битном режиме
- Реализация функций `initialize()`, `clear()`, `writeLine()`, `writeChar()` с реальной GPIO логикой
- Функция `setCursorPosition()` для установки позиции курсора

### 2. spot_lcd_cpp/include/spot_lcd_node.h

**Обновлен** с добавлением:

- Объявления функции `setCursorPosition()` в приватной секции класса `LcdDisplay`

### 3. spot_lcd_cpp/CMakeLists.txt

**Обновлен**:

- Изменена опция `ENABLE_GPIO` с `OFF` на `ON` по умолчанию

### 4. Dockerfile изменения

**Обновлены** следующие Dockerfile:

- `docker/lcd/Dockerfile.cpp`: Добавлена установка wiringpi, включена GPIO поддержка при сборке
- `docker/lcd/Dockerfile.ros2`: Включена GPIO поддержка при сборке
- `docker/lcd/Dockerfile.min`: Добавлена установка wiringpi

## Технические детали реализации

### GPIO пины (из конфигурации)
- pin_rs = 25 (Register Select)
- pin_en = 24 (Enable)
- pins_data = [23, 17, 18, 22] (Data pins 4-7 для 4-битного режима)
- cols = 16, rows = 2 (размеры дисплея)

### Инициализация LCD
Реализована стандартная последовательность инициализации для HD44780 в 4-битном режиме:
1. Последовательность из трех 0x30 команд с задержками
2. Перевод в 4-битный режим
3. Установка функций: 2 строки, 5x8 точек
4. Включение дисплея
5. Установка режима ввода
6. Очистка дисплея

### Формат отображения
- Line 0: "Temp: [температура]"
- Line 1: "Up: [аптайм]"
- Обновление каждую секунду
- Автоматическое заполнение пробелами до конца строки

## Проверка после внедрения

После деплоя обновленного образа:

1. Убедитесь, что контейнер запускается с привилегиями для доступа к GPIO
2. Проверьте, что пины 25, 24, 23, 17, 18, 22 правильно подключены к LCD дисплею
3. Мониторьте логи контейнера на предмет успешной инициализации WiringPi
4. Проверьте отображение текста на физическом LCD дисплее

## GitHub Actions
После внесения изменений в репозиторий автоматически запустится сборка нового образа через GitHub Actions.